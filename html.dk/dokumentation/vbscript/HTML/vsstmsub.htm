<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sub Statement</TITLE>
<!--CSS_START-->
<style>@import url(../html-vss/msdnie4a.css);</style>
<link disabled rel="stylesheet" href="../html-vss/msdn_ie3.css">
<!--CSS_END-->
</HEAD>
<BODY>


<!--Start Head-->
<TABLE class="banner" width="100%" CELLSPACING=0>
<TR>
<TD class="bannerleft" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD class="bannerright" nowrap><a href="../html-vss/vbsTOC.htm">Language Reference</a></TD>
</TR>
</TABLE>
<HR>
<!--End Head-->

<H1><A NAME="vsstmsub"></A>Sub Statement</H1>

<P>Declares the name, arguments, and code that form the body of a <B>Sub</B> procedure.</P>

<P><CODE>[<B>Public</B> [<B>Default</B>] | <B>Private</B>] <B>Sub</B> <I>name</I> [<B>(</B><I>arglist</I><B>)</B>] <BR>
&nbsp;&nbsp;&nbsp;[<I>statements</I>]<BR>
&nbsp;&nbsp;&nbsp;[<B>Exit Sub</B>]<BR>
&nbsp;&nbsp;&nbsp;[<I>statements</I>]<BR>
<B>End Sub</B></CODE></P>

<H4>Arguments</H4>

<P class=dt><I>Public</I></P>

<P class=indent>Indicates that the <B>Sub</B> procedure is accessible to all other procedures in all scripts.</P>

<P class=dt><I>Default</I></P>

<P class=indent>Used only with the <B>Public</B> keyword in a <B>Class</B> block to indicate that the <B>Sub</B> procedure is the default method for the <A HREF="vtglossary.htm#defclassvbs">class</A>. An error occurs if more than one <B>Default</B> procedure is specified in a class.</P>

<P class=dt><I>Private</I></P>

<P class=indent>Indicates that the <B>Sub</B> procedure is accessible only to other procedures in the script where it is declared.</P>

<P class=dt><I>name</I></P>

<P class=indent>Name of the <B>Sub</B>; follows standard <A HREF="vtglossary.htm#defvariablevbs">variable</A> naming conventions.</P>

<P class=dt><I>arglist</I></P>

<P class=indent>List of variables representing arguments that are passed to the <B>Sub</B> procedure when it is called. Multiple variables are separated by commas.</P>

<P class=dt><I>statements</I></P>

<P class=indent>Any group of statements to be executed within the body of the <B>Sub</B> procedure.</P>

<P>The <I>arglist</I> argument has the following syntax and parts:</P>

<P><CODE>[<B>ByVal </B>| <B>ByRef</B>] <I>varname</I>[<B>( )</B>]</CODE></P>

<H4>Arguments</H4>

<P class=dt><I>ByVal</I></P>

<P class=indent>Indicates that the <A HREF="vtglossary.htm#defargumentvbs">argument</A> is passed <A HREF="vtglossary.htm#defbyvaluevbs">by value</A>.</P>

<P class=dt><I>ByRef</I></P>

<P class=indent>Indicates that the argument is passed <A HREF="vtglossary.htm#defbyreferencevbs">by reference</A>.</P>

<P class=dt><I>varname</I></P>

<P class=indent>Name of the variable representing the argument; follows standard variable naming conventions.</P>

<H4>Remarks</H4>

<P>If not explicitly specified using either <A HREF="vtglossary.htm#defpublicvbs">Public</A> or <A HREF="vtglossary.htm#defprivatevbs">Private</A>, <B>Sub</B> procedures are public by default, that is, they are visible to all other procedures in your script. The value of local variables in a <B>Sub</B> procedure is not preserved between calls to the <A HREF="vtglossary.htm#defprocedurevbs">procedure</A>.</P>

<P>You can't define a <B>Sub</B> procedure inside any other procedure (e.g. <B>Function</B> or <B>Property Get</B>).</P>

<P>The <B>Exit Sub </B>statement causes an immediate exit from a <B>Sub</B> procedure. Program execution continues with the statement that follows the statement that called the <B>Sub</B> procedure. Any number of <B>Exit Sub</B> statements can appear anywhere in a <B>Sub</B> procedure.</P>

<P>Like a <B>Function</B> procedure, a <B>Sub</B> procedure is a separate procedure that can take arguments, perform a series of statements, and change the value of its arguments. However, unlike a <B>Function</B> procedure, which returns a value, a <B>Sub</B> procedure can't be used in an <A HREF="vtglossary.htm#defexpressionvbs">expression</A>.</P>

<P>You call a <B>Sub</B> procedure using the procedure name followed by the argument list. See the <B>Call</B> statement for specific information on how to call <B>Sub</B> procedures.</P>

<P class=indent><B>Caution&nbsp;&nbsp;&nbsp;Sub</B> procedures can be recursive, that is, they can call themselves to perform a given task. However, recursion can lead to stack overflow. </P>

<P>Variables used in <B>Sub</B> procedures fall into two categories: those that are explicitly declared within the procedure and those that are not. Variables that are explicitly declared in a procedure (using <B>Dim</B> or the equivalent) are always local to the procedure. Variables that are used but not explicitly declared in a procedure are also local, unless they are explicitly declared at some higher level outside the procedure.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>A procedure can use a variable that is not explicitly declared in the procedure, but a naming conflict can occur if anything you have defined at the <A HREF="vtglossary.htm#defscriptlevelvbs">script level</A> has the same name. If your procedure refers to an undeclared variable that has the same name as another procedure, <A HREF="vtglossary.htm#defconstantvbs">constant</A> or variable, it is assumed that your procedure is referring to that script-level name. To avoid this kind of conflict, use an <B>Option Explicit</B> statement to force explicit declaration of variables.</P>

<H4>Requirements</H4>

<P><A HREF="vtoriversioninformation.htm">Version 1</A></P>

<H4>See Also</H4>

<P><A HREF="vsstmcall.htm">Call Statement</A> | <A HREF="vsstmdim.htm">Dim Statement</A> | <A HREF="vsstmexit.htm">Exit Statement</A> | <A HREF="vsstmfunction.htm">Function Statement</A></P>
<!--Copyright_START-->
<DIV CLASS="footer">
<HR><a href="vbscopy.htm">&copy;2000 Microsoft Corporation. All rights reserved.</a><br>
</DIV> <!--Copyright_END-->

</BODY>
</HTML>
