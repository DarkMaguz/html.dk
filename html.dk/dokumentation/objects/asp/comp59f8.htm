<html><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<title>Ad Rotator Component</title>
<script language="JavaScript">

    szNavVersion = navigator.appVersion

    if (navigator.appName == "Microsoft Internet Explorer") {
	if (szNavVersion.indexOf ("4.") >= 0) {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
	} else {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
	}
    }
    else if (navigator.appName == "Netscape") {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
    }
    else {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
    }

</script>
<meta NAME="DESCRIPTION" CONTENT="Internet Information Server reference information"></head>
<body BGCOLOR="#FFFFFF" TEXT="#000000">
<font face="Verdana, Arial, Helvetica">
<h2><a name="_ad_rotator_component"></a>Ad Rotator Component</h2>
<p>
The Ad Rotator component creates an <b>Ad Rotator</b> object that automates the rotation of advertisement images on a Web page. Each time a user opens or reloads the Web page, the Ad Rotator component displays a new advertisement based on the information you specify in a <a href="comp6okl.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp6okl.htm"><b>Rotator Schedule File</b></a>. </p>
<p>
You can record how many users click each advertisement by setting the URL parameter in the Rotator Schedule file to direct users to the Redirection File. When you specify this parameter, each jump to an advertiser's URL is recorded in the Web server activity logs. For more information on activity logs, see <a href="javascript:if(confirm('http://www.activeserverpages.dk/iis/htm/core/iilogsa.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iis/htm/core/iilogsa.htm'" tppabs="http://www.activeserverpages.dk/iis/htm/core/iilogsa.htm"><b>Logging Web Site Activity</b></a>.</p>
<h5>File Names</h5>
<table>
<tr valign="top">
<td>
adrot.dll </td>
<td>
The Ad Rotator<b> </b>component.</td>
</tr>
<tr valign="top">
<td>
<a href="comp0hr9.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp0hr9.htm"><b>Redirection File</b></a> </td>
<td>
An optional file that implements redirection and enables the Ad Rotator component to record how many users click on each advertisement.</td>
</tr>
<tr valign="top">
<td>
<a href="comp6okl.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp6okl.htm"><b>Rotator Schedule File</b></a></td>
<td>
A text file that contains the display schedule and file information for advertisements. This file must be available on a Web server virtual path.</td>
</tr>
</table><br>
<h5>Syntax</h5>
<pre><b>Set </b><i>AdRotator</i> <b>= Server.CreateObject(&quot;MSWC.AdRotator&quot;)</b> 
 </pre>
<h5>Parameters</h5>
<dl>
<dt>
<i>AdRotator</i></dt>
<dd>
Specifies the name of the <b>AdRotator </b>object created by the call to <b>Server.CreateObject</b>.</dd>
</dl>
<h5>Registry Entries</h5>
<p>
None. </p>
<h5>Properties</h5>
<table>
<tr valign="top">
<td>
<a href="comp14fm.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp14fm.htm"><b>Border</b></a></td>
<td>
Specifies the size of the border around the advertisement.</td>
</tr>
<tr valign="top">
<td>
<a href="comp5279.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp5279.htm"><b>Clickable</b></a></td>
<td>
Specifies whether the advertisement is a hyperlink.</td>
</tr>
<tr valign="top">
<td>
<a href="comp1ag5.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp1ag5.htm"><b>TargetFrame</b></a> </td>
<td>
Specifies the name of the frame in which to display the advertisement.</td>
</tr>
</table><br>
<h5>Methods</h5>
<table>
<tr valign="top">
<td>
<a href="comp4z90.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/comp4z90.htm"><b>GetAdvertisement</b></a></td>
<td>
Gets the specifications for the next scheduled advertisement from the data file and formats it as HTML.</td>
</tr>
</table><br>
<h5>Example</h5>
<p>
The following example displays a different advertisement each time a user views the Web page. </p>
<pre>&lt;%  Set ad = Server.CreateObject(&quot;MSWC.AdRotator&quot;) %&gt;  <br> 
&lt;%= ad.GetAdvertisement(&quot;/ads/adrot.txt&quot;) %&gt;  
 </pre>
<p>
The following HTML is generated by the <b>GetAdvertisement</b> method and added to the page's output, displaying the next advertisement in the Rotator Schedule file.</p>
<pre>&lt;A HREF=&quot;http://www.msn.com/isapi/adredir.asp?http://www.company.com/&quot;&gt; 

&lt;IMG SRC=&quot;http://msnnt3web/ads/homepage/chlogolg.gif&quot; <br>ALT=&quot;Check out the new Technology Center&quot; <br>WIDTH=440 HEIGHT=60 BORDER=1&gt;&lt;/A&gt; 
 </pre>
<hr class="iis" size="1">
<p align="center"><em><a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/common/colegal.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/common/colegal.htm'" tppabs="http://www.activeserverpages.dk/iishelp/common/colegal.htm">© 1997 by Microsoft Corporation. All rights reserved.</a></em></p>
</body>
</html>
