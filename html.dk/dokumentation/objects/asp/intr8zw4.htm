<html><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<title>Application Object</title>
<script language="JavaScript">

    szNavVersion = navigator.appVersion

    if (navigator.appName == "Microsoft Internet Explorer") {
	if (szNavVersion.indexOf ("4.") >= 0) {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
	} else {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
	}
    }
    else if (navigator.appName == "Netscape") {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
    }
    else {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
    }

</script>
<META NAME="DESCRIPTION" CONTENT="Internet Information Server reference information"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="Verdana, Arial, Helvetica">
<h2><a name="_application_object"></a>Application Object</h2>
<p>
You can use the <b>Application</b> object to share information among all users of a given application. An ASP-based application is defined as all the .asp files in a virtual directory and its subdirectories. Because the <b>Application</b> object can be shared by more than one user, there are <b>Lock</b> and <b>Unlock </b>methods to ensure that multiple users do not try to alter a property simultaneously.</p>
<h4>Syntax</h4>
<pre><b>Application.</b><i>method</i> 
 </pre>
<h4>Collections</h4>
<table>
<tr valign=top>
<td>
<a href="intr129a.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr129a.htm"><b>Contents</b></a></td>
<td>
Contains all of the items that have been added to the Application through script commands.</td>
</tr>
<tr valign=top>
<td>
<a href="intr5uem.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr5uem.htm"><b>StaticObjects</b></a></td>
<td>
Contains all of the objects added to the session with the &lt;OBJECT&gt; tag. </td>
</tr>
</table><br>
<h4>Methods</h4>
<table>
<tr valign=top>
<td>
<a href="intr84h7.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr84h7.htm"><b>Lock</b></a></td>
<td>
The <b>Lock </b>method prevents other clients from modifying <b>Application </b>object properties.</td>
</tr>
<tr valign=top>
<td>
<a href="intr51gr.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr51gr.htm"><b>Unlock</b></a></td>
<td>
The <b>Unlock </b>method allows other clients to modify <b>Application </b>object properties.</td>
</tr>
</table><br>
<h4>Events</h4>
<table>
<tr valign=top>
<td>
<a href="glob6zc4.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob6zc4.htm"><b>Application_OnEnd</b></a></td>
</tr>
<tr valign=top>
<td>
<a href="glob4f78.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob4f78.htm"><b>Application_OnStart</b></a></td>
</tr>
</table><br>
<p>
Scripts for the preceding events are declared in the global.asa file. For more information about these events and the global.asa file, see the <a href="glob63vp.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob63vp.htm"><b>Global.asa Reference</b></a>.</p>
<h4>Remarks</h4>
<p>
You can store values in the <a href="intr3z77.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr3z77.htm"><b>Application</b> <b>Collections</b></a>. Information stored in the <b>Application </b>collections<b> </b>is available throughout the application and has application scope. The following script demonstrates storage of two types of variables.</p>
<pre>&lt;% 
Application(&quot;greeting&quot;) = &quot;Welcome to My Web World!&quot;
Application(&quot;num&quot;) = 25
%&gt;
 </pre>
<p>
Each of these variables would be members of the <a href="intr129a.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr129a.htm"><b>Application Contents Collection</b></a>. </p>
<p>
You can also assign a component instance to a variable that has application scope. If you assign a component instance to a variable with the <b>Server.CreateObject</b> method, the variable will be a member of the <b>Application.Contents</b> collection. If the variable is assigned with the &lt;OBJECT&gt; tag, the variable will be a member of the <a href="intr5uem.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr5uem.htm"><b>Application StaticObjects Collection</b></a>.</p>
<p>
You should be careful about assigning component instances to variables with application scope., as some components are not designed to be given application scope. For more information, see <a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc3vtx.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc3vtx.htm'" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc3vtx.htm"><b>Determining</b> <b>Component</b> <b>Scope</b></a> in the Creating Components for ASP section of the Programmer's Reference.</p>
<p>
If you assign a component instance to a variable in the <a href="intr129a.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/intr129a.htm"><b>Application</b> <b>Contents Collection</b></a>, and use Visual Basic&reg; Scripting Edition as your primary scripting language, you must use the <b>Set </b>keyword. This is illustrated in the following script. </p>
<pre>&lt;% Set Application(&quot;Obj1&quot;) = Server.CreateObject(&quot;MyComponent&quot;) %&gt;
 </pre>
<p>
You can then reference the methods and properties of <code>MyComponent</code> on subsequent Web pages by using this script</p>
<pre>&lt;% Application(&quot;Obj1&quot;).MyObjMethod %&gt;
 </pre>
<p>
or by extracting a local copy of the object and using the following</p>
<pre>&lt;% 
Set MyLocalObj1 = Application(&quot;Obj1&quot;) 
MyLocalObj1.MyObjMethod
%&gt;
 </pre>
<p>
Another way to create objects with application scope is by using the &lt;OBJECT&gt; tag in the global.asa file. For more information, see the <a href="glob63vp.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob63vp.htm"><b>Global.asa Reference</b></a>.</p>
<p>
You cannot store a built-in object in the <b>Application </b>object. For example, each of the following lines returns an error.</p>
<pre>&lt;%
Set Application(&quot;var1&quot;) = Session
Set Application(&quot;var2&quot;) = Request
Set Application(&quot;var3&quot;) = Response
Set Application(&quot;var4&quot;) = Server
Set Application(&quot;var5&quot;) = Application
Set Application(&quot;var6&quot;) = ObjectContext
%&gt;
 </pre>
<p>
You should be aware of the threading model used by any components you give application scope. The threading model used to develop the component will have a significant impact on whether a component instance should be assigned to a variable in one of the <b>Application </b>collections. For more information, see <a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc80qb.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc80qb.htm'" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/sdk/crtc80qb.htm"><b>Component</b> <b>Design</b> <b>Guidelines</b></a>.</p>
<p>
If you store an array in a <b>Application </b>object, you should not attempt to alter the elements of the stored array directly. For example, the following script does not work</p>
<pre>&lt;% Application(&quot;StoredArray&quot;)(3) = &quot;new value&quot; %&gt;
 </pre>
<p>
This is because the <b>Application </b>object is implemented as a collection. The array element <code>StoredArray(3)</code> does not receive the new value. Instead, the value would be included in the <b>Application</b> object collection, and would overwrite any information that had previously been stored at that location. </p>
<p>
It is strongly recommended that if you store an array in the <b>Application </b>object, you retrieve a copy of the array before retrieving or changing any of the elements of the array. When you are done with the array, you should store the array in the <b>Application </b>object all over again, so that any changes you made are saved. This is demonstrated in the following scripts.</p>
<pre>---file1.asp---
&lt;%
'Creating and initializing the array
dim MyArray()
Redim MyArray(5)
MyArray(0) = &quot;hello&quot;
MyArray(1) = &quot;some other string&quot;

'Storing the array in the Application object
Application.Lock
Application(&quot;StoredArray&quot;) = MyArray
Application.Unlock

Response.Redirect(&quot;file2.asp&quot;)
%&gt;

---file2.asp---
&lt;%
'Retrieving the array from the Application Object
'and modifying its second element
LocalArray = Application(&quot;StoredArray&quot;)
LocalArray(1) = &quot; there&quot;

'printing out the string &quot;hello there&quot;
Response.Write(LocalArray(0)&amp;LocalArray(1))

'Re-storing the array in the Application object
'This overwrites the values in StoredArray with the new values
Application.Lock
Application(&quot;StoredArray&quot;) = LocalArray
Application.Unlock
%&gt;
 </pre>
<h4>Example</h4>
<p>
The following example uses the application variable <code>NumVisits</code> to store the number of times that a particular page has been accessed. The <b>Lock</b> method is called to ensure that only the current client can access or alter <code>NumVisits</code>. Calling the <b>Unlock</b> method then enables other users to access the <b>Application</b> object.</p>
<pre>&lt;%
Application.Lock
Application(&quot;NumVisits&quot;) = Application(&quot;NumVisits&quot;) + 1
Application.Unlock
%&gt; 
 
This application page has been visited 
&lt;%= Application(&quot;NumVisits&quot;) %&gt; times!
 </pre>
<hr class="iis" size="1">
<p align="center"><em><a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/common/colegal.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/common/colegal.htm'" tppabs="http://www.activeserverpages.dk/iishelp/common/colegal.htm">&copy; 1997 by Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
