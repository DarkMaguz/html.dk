<html><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<title>Page Counter Component</title>
<script language="JavaScript">

    szNavVersion = navigator.appVersion

    if (navigator.appName == "Microsoft Internet Explorer") {
	if (szNavVersion.indexOf ("4.") >= 0) {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
	} else {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
	}
    }
    else if (navigator.appName == "Netscape") {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
    }
    else {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
    }

</script>
<META NAME="DESCRIPTION" CONTENT="Internet Information Server reference information"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="Verdana, Arial, Helvetica">
<h1><a name="_page_counter_component"></a>Page Counter Component</h1>
<p>
The Page Counter component creates a <b>PageCounter</b> object that counts and displays the number of times a Web page has been opened. At regular intervals the object writes the number of hits to a text file so that in the event of a server shutdown, the data is not lost. The Page Counter component uses an internal <b>Central Management </b>object to record how many times each page in the application has been opened. </p>
<p>
When an instance of the <b>PageCounter</b> object is created on a page by using the <b>Server.CreateObject</b> method, the object retrieves the current hit count for the specified Web page from the <b>Central Management</b> object. The object can then be manipulated with the methods it exposes.</p>
<p>
The Page Counter component uses the following files:</p>
<table>
<tr valign=top>
<td>
<b>File Names</b></td>
<td>
</td>
</tr>
<tr valign=top>
<td>
pagecnt.dll </td>
<td>
The Page Counter<b> </b>component.</td>
</tr>
<tr valign=top>
<td>
<a href="page7aw5.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/page7aw5.htm"><b>Hit Count Data file</b></a> &nbsp;</td>
<td>
The text file to which the Page Counter<b> </b>component saves the current hit count.</td>
</tr>
</table><br>
<h3>Syntax</h3>
<pre><b>&lt;% Set </b><i>oVar </i><b>= Server.CreateObject(&quot;MSWC.PageCounter&quot;) %&gt;</b> 
 </pre>
<h3>Parameters</h3>
<dl>
<dt>
<i>oVar</i></dt>
<dd>
Specifies the name of the <b>PageCounter</b> object created by the call to <b>Server.CreateObject</b>. </dd>
</dl>
<h3>Registry Entries</h3>
<p>
The Page Counter adds the key MSWC.PageCounter to the registry when the object is compiled or registered. The key is added under HKEY_CLASSES_ROOT and contains the following named values.</p>
<table>
<tr valign=top>
<td>
<b>Named Value</b></td>
<td>
<b>Description</b></td>
</tr>
<tr valign=top>
<td>
File_Location&nbsp;</td>
<td>
A string that specifies the path and filename of the Hit Count Data file. The default filename is hitcnt.cnt. This file is located in your Windows directory.</td>
</tr>
<tr valign=top>
<td>
Save_Count&nbsp;</td>
<td>
A DWORD that specifies the number of hits before the hit count is saved to the Hit Count Data file. Note that this is the total number of hits, not the number of hits per page. The default value is 25. </td>
</tr>
</table><br>
<h3>Methods</h3>
<table>
<tr valign=top>
<td>
<a href="page559v.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/page559v.htm"><b>Hits</b></a></td>
<td>
Displays the number of times that a specified URL has been opened. </td>
</tr>
<tr valign=top>
<td>
<a href="page2bhw.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/page2bhw.htm"><b>PageHit</b></a></td>
<td>
Increments the Hit Count. </td>
</tr>
<tr valign=top>
<td>
<a href="page2qic.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/page2qic.htm"><b>Reset</b></a></td>
<td>
Sets the hit count for a specified page to 0.</td>
</tr>
</table><br>
<h3>Example</h3>
<p>
The following example uses the <b>PageCounter</b> object to track the number of visitors to the page and sends a special message to the millionth visitor.</p>
<pre>&lt;% 
Set MyPageCounter = Server.CreateObject(&quot;MSWC.PageCounter&quot;)
HitMe = MyPageCounter.Hits

If HitMe = 1000000 Then 
%&gt;
  You are the lucky 1,000,000th Customer!!! &lt;BR&gt;
&lt;% Else %&gt;
  Sorry, you are customer #&lt;%= HitMe %&gt; &lt;BR&gt;
&lt;% End If %&gt;
 </pre>
<p>
<b>Note</b>  This component is not installed with IIS. You can install it from the Microsoft Web site at: <a href="javascript:if(confirm('http://www.microsoft.com/iis/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.microsoft.com/iis/'" tppabs="http://www.microsoft.com/iis/"><b>http://www.microsoft.com/iis/</b></a>, or from the CD included with the IIS Resource Kit.</p>
<hr class="iis" size="1">
<p align="center"><em><a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/common/colegal.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/common/colegal.htm'" tppabs="http://www.activeserverpages.dk/iishelp/common/colegal.htm">&copy; 1997 by Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
