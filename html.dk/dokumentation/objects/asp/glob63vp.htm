<html><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<title>Global.asa Reference</title>
<script language="JavaScript">

    szNavVersion = navigator.appVersion

    if (navigator.appName == "Microsoft Internet Explorer") {
	if (szNavVersion.indexOf ("4.") >= 0) {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
	} else {
	    document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
	}
    }
    else if (navigator.appName == "Netscape") {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie4.css">');
    }
    else {
	document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/spidie3.css">');
    }

</script>
<meta NAME="DESCRIPTION" CONTENT="Internet Information Server reference information"></head>
<body BGCOLOR="#FFFFFF" TEXT="#000000">
<font face="Verdana, Arial, Helvetica">
<h1><a name="_global.asa_reference"></a>Global.asa Reference</h1>
<p>
The Global.asa file is an optional file in which you can specify event scripts and declare objects that have session or application scope. It is not a content file displayed to the users; instead it stores event information and objects used globally by the application. This file must be named Global.asa and must be stored in the root directory of the application. An application can only have one Global.asa file.</p>
<p>
Global.asa files can contain only the following:
<ul>
<li>
<a href="glob3gj7.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob3gj7.htm"><b>Application events</b></a><br><br></li>
<li>
<a href="glob5j03.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob5j03.htm"><b>Session events</b></a><p></li>
<li>
<a href="glob822b.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob822b.htm"><b>&lt;OBJECT&gt; Declarations</b></a></p></li>
<li>
<a href="glob4b5f.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/glob4b5f.htm"><b>TypeLibrary Declarations</b></a></li>
</ul>
<p>
If you include script that is not enclosed by &lt;SCRIPT&gt; tags, or that defines an object that does not have session or application scope, the server returns an error. The server ignores both tagged script that the application or session events do not use, as well as any HTML in the file.</p>
<p>
The scripts contained in the Global.asa file may be written in any supported scripting language. If multiple event or object scripts use the same scripting language, they can be combined inside a single set of &lt;SCRIPT&gt; tags.</p>
<p>
When you save changes to the Global.asa file, the server finishes processing all of the current application requests before it recompiles the Global.asa file. During that time, the server refuses additional requests and returns an error message stating that the request cannot be processed while the application is being restarted.</p>
<p>
After all of the current user requests have been processed, the server deletes all active sessions, calling the <b>Session_OnEnd</b> event for each session it deletes, closes the application, and calls the <b>Application_OnEnd</b> event. The Global.asa file is then recompiled. Subsequent user requests will start the application and create new sessions, and trigger the <b>Application_OnStart</b> and <b>Session_OnStart</b> events.</p>
<p>
However, saving changes to a file that is included by the Global.asa file does not cause the server to recompile Global.asa. In order for the server to recognize changes in the included file, you must once again save the Global.asa file. </p>
<p>
Procedures declared in the Global.asa file can only be called from one or more of the scripts associated with the <b>Application_OnStart</b>, <b>Application_OnEnd</b>, <b>Session_OnStart</b>, and <b>Session_OnEnd </b>events. They are not available to the ASP pages in the ASP-based application. </p>
<p>
To share procedures across an application, you can declare the procedures in a separate file, and then use server-side include (SSI) statements to include the file in the ASP pages that call the procedures. You typically give include files an .inc extension.</p>
<p>
<b>Note</b>  The examples in this document use Microsoft® Visual Basic® Scripting Edition (VBScript) as the primary scripting language. However, ASP scripts can be written in any supported scripting language, such as JScript&#153;. For more information on how to change the primary language, see <a href="iiwascln.htm" tppabs="http://www.activeserverpages.dk/iishelp/iis/htm/asp/iiwascln.htm"><b>Working with Scripting Languages</b></a>.</p>
<hr class="iis" size="1">
<p align="center"><em><a href="javascript:if(confirm('http://www.activeserverpages.dk/iishelp/common/colegal.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.activeserverpages.dk/iishelp/common/colegal.htm'" tppabs="http://www.activeserverpages.dk/iishelp/common/colegal.htm">© 1997 by Microsoft Corporation. All rights reserved.</a></em></p>
</body>
</html>
